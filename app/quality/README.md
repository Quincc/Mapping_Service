# Quality Module

Модуль `app/quality` отвечает за проверку качества данных, загружаемых в систему. Его основная задача — применить заранее определённые правила валидации к DataFrame, полученному на этапе парсинга, и сформировать отчёт с результатами.

## Структура модуля

* **checker.py** — основной движок проверки. Загружает правила, применяет их к данным, сохраняет отчёты.
* **rules.py** — набор валидаторов, каждый из которых представляет конкретную проверку (например, пустые значения, допустимые диапазоны и т.д.).
* **schemas.py** — Pydantic-схемы для валидации входных и выходных структур.
* **storage.py** — сохранение отчётов проверки в CSV-файлы.
* **router.py** — API-интерфейс FastAPI, обеспечивающий вызов проверок извне (если нужно).
* **test\_checker.py** — автотесты для проверки корректности работы правил.

## Принцип работы

1. Файл загружается пользователем и передаётся в модуль парсинга.
2. Парсер формирует pandas DataFrame.
3. Этот DataFrame передаётся в `checker.run_quality_checks()` вместе с `project_id`.
4. Каждое правило из `rules.py` последовательно применяется к таблице.
5. Результаты записываются в CSV-файл (один на проект).
6. В случае проблем создаются записи логов и события (если настроены).

## Расширение

Чтобы добавить новое правило:

* Создайте функцию в `rules.py` и зарегистрируйте её в списке `RULES`.
* Обеспечьте корректную структуру возврата `QualityIssue` (из `schemas.py`).
* Добавьте тест в `test_checker.py`.

## Зависимости

* `pandas`
* `pydantic`
* `FastAPI`

## Назначение

Этот модуль помогает обеспечить надёжность данных, предотвращая распространение некачественной информации дальше по пайплайну.

---

Если необходимо сгенерировать отчёты повторно — вызовите `run_quality_checks(project_id, df)` вручную, либо через API, если подключён маршрут `router.py`.
